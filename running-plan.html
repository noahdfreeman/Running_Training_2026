<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Running Training Plan (Post-Monumental → Indy Mini)</title>
<style>
:root{
  --bg:#0e1117; --card:#161a22; --ink:#f5f7fb; --muted:#9aa3af;
  --accent:#3ddc97; --accent2:#60a5fa; --line:#232a36; --race:#ffb4b4;
}
*{box-sizing:border-box}
body{margin:0;background:linear-gradient(180deg,#0b0f14,#141821);color:var(--ink);
     font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,Arial,sans-serif}
header{padding:24px 16px;text-align:center}
header h1{margin:0 0 4px;font-weight:800}
header p{margin:0;color:var(--muted)}
.controls{display:flex;flex-wrap:wrap;gap:12px;align-items:center;justify-content:space-between;
          padding:12px 16px;background:var(--card);border-top:1px solid var(--line);border-bottom:1px solid var(--line)}
.controls button{background:var(--accent2);color:#001428;border:0;padding:8px 12px;border-radius:8px;cursor:pointer}
.controls input[type=week]{background:#0f131a;color:var(--ink);border:1px solid #293244;padding:8px;border-radius:8px}
.stats{display:flex;gap:16px;color:var(--muted)}
main{padding:16px}
table{width:100%;border-collapse:separate;border-spacing:0;background:var(--card);border-radius:12px;overflow:hidden}
thead{background:#11141a;color:var(--muted)}
th,td{padding:12px 10px;border-bottom:1px solid var(--line);vertical-align:top}
th.num,td.num{text-align:right}
tbody tr:hover{background:#131823}
footer{display:flex;gap:10px;justify-content:center;padding:18px;color:var(--muted)}
footer button{background:#2a3040;color:var(--ink);border:1px solid #323c52;padding:8px 12px;border-radius:8px;cursor:pointer}
.doneCell input{transform:scale(1.25)}
tr[data-workout="RACE"]{background:rgba(255,180,180,0.08)}
tr[data-workout="RACE"] td{border-bottom-color:rgba(255,180,180,0.25)}
.badge{display:inline-block;background:#21283a;border:1px solid #2f3a51;color:#c7d2fe;border-radius:999px;
       padding:2px 8px;margin-left:6px;font-size:12px}
</style>
</head>
<body>
<header>
  <h1>Running Training Plan</h1>
  <p>After Monumental Half (starts Nov 9, 2025) → Carmel Marathon → Indy Mini</p>
</header>

<section class="controls">
  <div>
    <button id="prevWeek" aria-label="Previous week">←</button>
    <input type="week" id="weekPicker" aria-label="Week picker" />
    <button id="nextWeek" aria-label="Next week">→</button>
    <span class="badge">E 8:30–9:15</span>
    <span class="badge">T 6:55–7:15</span>
    <span class="badge">M 7:30–7:40</span>
    <span class="badge">I 6:15–6:55</span>
  </div>
  <div class="stats">
    <span id="weekRange"></span>
    <span id="weekMiles">Week: 0.0 mi</span>
    <span id="progress">Done: 0%</span>
  </div>
</section>

<main>
  <table id="plan">
    <thead>
      <tr>
        <th>Date</th>
        <th>Day</th>
        <th>Phase</th>
        <th>Workout</th>
        <th class="num">Miles</th>
        <th>Notes / Pace</th>
        <th>Done</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</main>

<footer>
  <button id="showAll">Show entire plan</button>
  <button id="showWeek">Show current week</button>
  <button id="resetChecks">Reset checkmarks</button>
</footer>

<!-- Embedded CSV DATA (post–Nov 8 only) -->
<script id="data" type="text/csv">
Date,Day,Phase,Workout,Distance,Notes
2025-11-09,Sun,5K Sharpening,X,0,"Rest"
2025-11-10,Mon,5K Sharpening,X,0,"Rest"
2025-11-11,Tue,5K Sharpening,I,6,"8×400m @ 5K pace, 6:15–6:25/mi"
2025-11-12,Wed,5K Sharpening,E,5,"Easy, 8:30–9:15/mi"
2025-11-13,Thu,5K Sharpening,T,6,"4 mi tempo @ 10K/HM, 6:55–7:10/mi"
2025-11-14,Fri,5K Sharpening,E,4,"Easy, 8:30–9:15/mi"
2025-11-15,Sat,5K Sharpening,E,5,"Easy + strides, 8:30–9:15/mi"
2025-11-16,Sun,5K Sharpening,LR,10,"Long, 8:15–9:00/mi"
2025-11-17,Mon,5K Sharpening,X,0,"Rest"
2025-11-18,Tue,5K Sharpening,I,7,"5×800m @ 5K pace, 6:15–6:25/mi"
2025-11-19,Wed,5K Sharpening,E,5,"Easy, 8:30–9:15/mi"
2025-11-20,Thu,5K Sharpening,T,6,"5 mi tempo @ 10K, 6:50–6:55/mi"
2025-11-21,Fri,5K Sharpening,E,4,"Easy, 8:30–9:15/mi"
2025-11-22,Sat,5K Sharpening,E,5,"Easy, 8:30–9:15/mi"
2025-11-23,Sun,5K Sharpening,LR,11,"Long, 8:15–9:00/mi"
2025-11-24,Mon,5K Sharpening,X,0,"Rest"
2025-11-25,Tue,5K Sharpening,I,7,"10×400m @ 5K pace, 6:15–6:25/mi"
2025-11-26,Wed,5K Sharpening,E,5,"Easy, 8:30–9:15/mi"
2025-11-27,Thu,5K Sharpening,T,6,"5 mi tempo @ 10K, 6:50–6:55/mi"
2025-11-28,Fri,5K Sharpening,E,4,"Easy, 8:30–9:15/mi"
2025-11-29,Sat,5K Sharpening,E,6,"Easy + strides, 8:30–9:15/mi"
2025-11-30,Sun,5K Sharpening,LR,12,"Long, 8:15–9:00/mi"
2025-12-01,Mon,5K Sharpening,X,0,"Rest"
2025-12-02,Tue,5K Sharpening,I,8,"6×1K @ 10K, 6:45–6:55/mi"
2025-12-03,Wed,5K Sharpening,E,5,"Easy, 8:30–9:15/mi"
2025-12-04,Thu,5K Sharpening,T,5,"3 mi tempo @ 10K, 6:50–6:55/mi"
2025-12-05,Fri,5K Sharpening,E,4,"Easy, 8:30–9:15/mi"
2025-12-06,Sat,5K Sharpening,E,5,"Easy, 8:30–9:15/mi"
2025-12-07,Sun,5K Sharpening,LR,10,"Long, 8:15–9:00/mi"
2025-12-08,Mon,5K Sharpening,X,0,"Rest"
2025-12-09,Tue,5K Sharpening,I,6,"6×200m fast, 6:10–6:20/mi"
2025-12-10,Wed,5K Sharpening,E,4,"Easy, 8:30–9:15/mi"
2025-12-11,Thu,5K Sharpening,E,4,"Easy + strides, 8:30–9:15/mi"
2025-12-12,Fri,5K Sharpening,X,0,"Rest"
2025-12-13,Sat,5K Sharpening,RACE,3.1,"Race: 5K, Goal <20:00 (6:25/mi)"

2025-12-14,Sun,Marathon Build,X,0,"Rest"
2025-12-15,Mon,Marathon Build,X,0,"Rest"
2025-12-16,Tue,Marathon Build,T,7,"4 mi tempo @ HM, 7:10–7:15/mi"
2025-12-17,Wed,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2025-12-18,Thu,Marathon Build,E,7,"Easy, 8:30–9:15/mi"
2025-12-19,Fri,Marathon Build,X,0,"Rest"
2025-12-20,Sat,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2025-12-21,Sun,Marathon Build,LR,14,"Long, 8:15–9:00/mi"
2025-12-22,Mon,Marathon Build,X,0,"Rest"
2025-12-23,Tue,Marathon Build,I,7,"8×400m @ 10K, 6:45–6:55/mi"
2025-12-24,Wed,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2025-12-25,Thu,Marathon Build,M,8,"5 mi @ MP, 7:30–7:40/mi"
2025-12-26,Fri,Marathon Build,X,0,"Rest"
2025-12-27,Sat,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2025-12-28,Sun,Marathon Build,LR,15,"Long, 8:15–9:00/mi"
2025-12-29,Mon,Marathon Build,X,0,"Rest"
2025-12-30,Tue,Marathon Build,I,8,"6×800m @ 10K, 6:45–6:55/mi"
2025-12-31,Wed,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-01-01,Thu,Marathon Build,T,8,"5 mi tempo @ HM, 7:10–7:15/mi"
2026-01-02,Fri,Marathon Build,X,0,"Rest"
2026-01-03,Sat,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-01-04,Sun,Marathon Build,LR,16,"Long, 8:15–9:00/mi"
2026-01-05,Mon,Marathon Build,X,0,"Rest"
2026-01-06,Tue,Marathon Build,I,7,"5×1K @ 10K, 6:45–6:55/mi"
2026-01-07,Wed,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-01-08,Thu,Marathon Build,E,7,"Easy, 8:30–9:15/mi"
2026-01-09,Fri,Marathon Build,X,0,"Rest"
2026-01-10,Sat,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-01-11,Sun,Marathon Build,LR,14,"Long, 8:15–9:00/mi"
2026-01-12,Mon,Marathon Build,X,0,"Rest"
2026-01-13,Tue,Marathon Build,T,9,"5 mi tempo @ HM, 7:10–7:15/mi"
2026-01-14,Wed,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-01-15,Thu,Marathon Build,E,8,"Easy, 8:30–9:15/mi"
2026-01-16,Fri,Marathon Build,E,5,"Easy, 8:30–9:15/mi"
2026-01-17,Sat,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-01-18,Sun,Marathon Build,LR,17,"Long, 8:15–9:00/mi"
2026-01-19,Mon,Marathon Build,X,0,"Rest"
2026-01-20,Tue,Marathon Build,I,9,"6×1K @ 10K, 6:45–6:55/mi"
2026-01-21,Wed,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-01-22,Thu,Marathon Build,M,8,"6 mi @ MP, 7:30–7:40/mi"
2026-01-23,Fri,Marathon Build,E,5,"Easy, 8:30–9:15/mi"
2026-01-24,Sat,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-01-25,Sun,Marathon Build,LR,18,"Long, last 4 mi @ MP, 7:30–7:40/mi"
2026-01-26,Mon,Marathon Build,X,0,"Rest"
2026-01-27,Tue,Marathon Build,I,9,"8×800m @ 10K, 6:45–6:55/mi"
2026-01-28,Wed,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-01-29,Thu,Marathon Build,M,8,"6 mi @ MP, 7:30–7:40/mi"
2026-01-30,Fri,Marathon Build,E,5,"Easy, 8:30–9:15/mi"
2026-01-31,Sat,Marathon Build,E,6,"Easy + strides, 8:30–9:15/mi"
2026-02-01,Sun,Marathon Build,LR,16,"Long, 8:15–9:00/mi"
2026-02-02,Mon,Marathon Build,X,0,"Rest"
2026-02-03,Tue,Marathon Build,I,8,"5×1K @ 10K, 6:45–6:55/mi"
2026-02-04,Wed,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-02-05,Thu,Marathon Build,T,12,"10 mi tempo @ ~6:55–7:05/mi"
2026-02-06,Fri,Marathon Build,E,4,"Easy, 8:30–9:15/mi"
2026-02-07,Sat,Marathon Build,E,4,"Easy, 8:30–9:15/mi"
2026-02-08,Sun,Marathon Build,LR,18,"Long, last 4 mi @ MP, 7:30–7:40/mi"
2026-02-09,Mon,Marathon Build,X,0,"Rest"
2026-02-10,Tue,Marathon Build,I,9,"4×1.5 mi @ ~10K, 6:45–6:55/mi"
2026-02-11,Wed,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-02-12,Thu,Marathon Build,E,8,"Easy, 8:30–9:15/mi"
2026-02-13,Fri,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-02-14,Sat,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-02-15,Sun,Marathon Build,LR,19,"Long, 8:15–9:00/mi"
2026-02-16,Mon,Marathon Build,X,0,"Rest"
2026-02-17,Tue,Marathon Build,I,9,"10×400m @ 5K–10K, 6:20–6:55/mi"
2026-02-18,Wed,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-02-19,Thu,Marathon Build,M,10,"7 mi @ MP, 7:30–7:40/mi"
2026-02-20,Fri,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-02-21,Sat,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-02-22,Sun,Marathon Build,LR,20,"Long, 8:15–9:00/mi"
2026-02-23,Mon,Marathon Build,X,0,"Rest (cutback)"
2026-02-24,Tue,Marathon Build,I,8,"6×1K @ 10K, 6:45–6:55/mi"
2026-02-25,Wed,Marathon Build,E,7,"Easy, 8:30–9:15/mi"
2026-02-26,Thu,Marathon Build,T,11,"9 mi tempo @ ~6:55–7:05/mi"
2026-02-27,Fri,Marathon Build,X,0,"Rest (cutback)"
2026-02-28,Sat,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-03-01,Sun,Marathon Build,LR,16,"Long, 8:15–9:00/mi"
2026-03-02,Mon,Marathon Build,X,0,"Rest"
2026-03-03,Tue,Marathon Build,I,8,"5×1K @ 10K, 6:45–6:55/mi"
2026-03-04,Wed,Marathon Build,E,7,"Easy, 8:30–9:15/mi"
2026-03-05,Thu,Marathon Build,M,9,"7 mi @ MP, 7:30–7:40/mi"
2026-03-06,Fri,Marathon Build,E,7,"Easy, 8:30–9:15/mi"
2026-03-07,Sat,Marathon Build,E,7,"Easy, 8:30–9:15/mi"
2026-03-08,Sun,Marathon Build,LR,20,"Long, last 6 mi @ MP, 7:30–7:40/mi"
2026-03-09,Mon,Marathon Build,X,0,"Rest"
2026-03-10,Tue,Marathon Build,I,9,"12×400m @ 5K–10K, 6:20–6:55/mi"
2026-03-11,Wed,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-03-12,Thu,Marathon Build,T,12,"10 mi tempo @ ~6:55–7:05/mi"
2026-03-13,Fri,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-03-14,Sat,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-03-15,Sun,Marathon Build,LR,21,"Long, 8:15–9:00/mi"
2026-03-16,Mon,Marathon Build,X,0,"Rest"
2026-03-17,Tue,Marathon Build,I,9,"6×1K @ 10K, 6:45–6:55/mi"
2026-03-18,Wed,Marathon Build,E,8,"Easy, 8:30–9:15/mi"
2026-03-19,Thu,Marathon Build,M,10,"8 mi @ MP, 7:30–7:40/mi"
2026-03-20,Fri,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-03-21,Sat,Marathon Build,E,7,"Easy, 8:30–9:15/mi"
2026-03-22,Sun,Marathon Build,LR,22,"Long, last 8 mi @ MP, 7:30–7:40/mi"
2026-03-23,Mon,Marathon Build,X,0,"Rest (start taper)"
2026-03-24,Tue,Marathon Build,I,8,"10×400m @ 5K–10K, 6:20–6:55/mi"
2026-03-25,Wed,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-03-26,Thu,Marathon Build,T,11,"9 mi tempo @ ~6:55–7:05/mi"
2026-03-27,Fri,Marathon Build,E,4,"Easy, 8:30–9:15/mi"
2026-03-28,Sat,Marathon Build,E,5,"Easy, 8:30–9:15/mi"
2026-03-29,Sun,Marathon Build,LR,20,"Long, 8:15–9:00/mi"
2026-03-30,Mon,Marathon Build,X,0,"Rest"
2026-03-31,Tue,Marathon Build,I,8,"5×800m @ 10K, 6:45–6:55/mi"
2026-04-01,Wed,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-04-02,Thu,Marathon Build,M,8,"6 mi @ MP, 7:30–7:40/mi"
2026-04-03,Fri,Marathon Build,X,0,"Rest"
2026-04-04,Sat,Marathon Build,E,6,"Easy, 8:30–9:15/mi"
2026-04-05,Sun,Marathon Build,LR,14,"Long, 8:15–9:00/mi"
2026-04-06,Mon,Marathon Build,X,0,"Rest"
2026-04-07,Tue,Marathon Build,I,7,"6×400m @ 5K–10K, 6:20–6:55/mi"
2026-04-08,Wed,Marathon Build,E,5,"Easy, 8:30–9:15/mi"
2026-04-09,Thu,Marathon Build,M,6,"4 mi @ MP, 7:30–7:40/mi"
2026-04-10,Fri,Marathon Build,X,0,"Rest"
2026-04-11,Sat,Marathon Build,E,4,"Easy, 8:30–9:15/mi"
2026-04-12,Sun,Marathon Build,LR,10,"Long, 8:15–9:00/mi"
2026-04-13,Mon,Marathon Build,X,0,"Rest (race week)"
2026-04-14,Tue,Marathon Build,E,5,"Easy + strides, 8:30–9:15/mi"
2026-04-15,Wed,Marathon Build,E,4,"Easy, 8:30–9:15/mi"
2026-04-16,Thu,Marathon Build,E,4,"Easy, 8:30–9:15/mi"
2026-04-17,Fri,Marathon Build,X,0,"Rest"
2026-04-18,Sat,Marathon Build,RACE,26.2,"Race: Carmel Marathon — Goal 3:18–3:20 (7:38/mi)"
2026-04-19,Sun,Indy Mini Transition,X,0,"Rest (post-marathon)"
2026-04-20,Mon,Indy Mini Transition,X,0,"Rest"
2026-04-21,Tue,Indy Mini Transition,E,6,"Easy, 8:30–9:15/mi"
2026-04-22,Wed,Indy Mini Transition,E,5,"Easy, 8:30–9:15/mi"
2026-04-23,Thu,Indy Mini Transition,T,6,"3 mi tempo @ HM, 6:50–6:55/mi"
2026-04-24,Fri,Indy Mini Transition,E,4,"Easy, 8:30–9:15/mi"
2026-04-25,Sat,Indy Mini Transition,X,0,"Rest"
2026-04-26,Sun,Indy Mini Transition,LR,8,"Long, 8:15–9:00/mi"
2026-04-27,Mon,Indy Mini Transition,X,0,"Rest"
2026-04-28,Tue,Indy Mini Transition,I,5,"4×400m @ 5K, 6:15–6:25/mi"
2026-04-29,Wed,Indy Mini Transition,E,4,"Easy, 8:30–9:15/mi"
2026-04-30,Thu,Indy Mini Transition,E,4,"Easy + strides, 8:30–9:15/mi"
2026-05-01,Fri,Indy Mini Transition,X,0,"Rest"
2026-05-02,Sat,Indy Mini Transition,RACE,13.1,"Race: Indy Mini Half — Goal <1:30 (6:52/mi)"
</script>

<script>
const tbody = document.querySelector('#plan tbody');
const weekPicker = document.querySelector('#weekPicker');
const weekRangeEl = document.querySelector('#weekRange');
const weekMilesEl = document.querySelector('#weekMiles');
const progressEl = document.querySelector('#progress');
const btnPrev = document.querySelector('#prevWeek');
const btnNext = document.querySelector('#nextWeek');
const btnShowAll = document.querySelector('#showAll');
const btnShowWeek = document.querySelector('#showWeek');
const btnReset = document.querySelector('#resetChecks');

const csvText = document.querySelector('#data').textContent.trim();
let rows = [];   // parsed data
let showingAll = false;

function parseCSV(text){
  const lines = text.split(/\r?\n/);
  const headers = lines.shift().split(',');
  return lines.map(line=>{
    let parts=[], cur='', q=false;
    for (let i=0;i<line.length;i++){
      const c=line[i];
      if (c==='"'){ q=!q; continue; }
      if (c===','&& !q){ parts.push(cur); cur=''; continue; }
      cur+=c;
    }
    parts.push(cur);
    const o = {};
    headers.forEach((h,i)=>o[h.trim()] = (parts[i]||'').trim());
    o.DateISO = o.Date;
    o.jsDate = new Date(o.DateISO+'T00:00:00');
    o.Distance = parseFloat(o.Distance)||0;
    return o;
  });
}
function startOfWeek(d){ const x=new Date(d); const wd=(x.getDay()+6)%7; x.setDate(x.getDate()-wd); x.setHours(0,0,0,0); return x; }
function endOfWeek(d){ const x=startOfWeek(d); x.setDate(x.getDate()+6); return x; }
function fmt(d){ return d.toLocaleDateString(undefined,{month:'short',day:'numeric'}); }
function weekLabel(d){ const a=startOfWeek(d), b=endOfWeek(d); return `${fmt(a)} – ${fmt(b)}, ${b.getFullYear()}`; }

function render(forDate){
  tbody.innerHTML='';
  const so = startOfWeek(forDate), eo=endOfWeek(forDate);
  const view = showingAll? rows : rows.filter(r=>r.jsDate>=so && r.jsDate<=eo);

  let miles=0, done=0, runs=0;
  view.forEach(r=>{
    const tr=document.createElement('tr');
    tr.dataset.workout=r.Workout;
    const doneKey=`done:${r.DateISO}`;
    tr.innerHTML = `
      <td>${r.Date}</td>
      <td>${r.Day}</td>
      <td>${r.Phase}</td>
      <td>${r.Workout}</td>
      <td class="num">${r.Distance? r.Distance.toFixed(1): ''}</td>
      <td>${r.Notes}</td>
      <td class="doneCell"><input type="checkbox" ${localStorage.getItem(doneKey)?'checked':''}></td>`;
    tr.querySelector('input').addEventListener('change',e=>{
      if(e.target.checked) localStorage.setItem(doneKey,'1'); else localStorage.removeItem(doneKey);
      updateStats(forDate);
    });
    tbody.appendChild(tr);
    if (!showingAll){
      if (r.Distance) miles += r.Distance;
      if (r.Workout!=='X'){ runs++; if (localStorage.getItem(doneKey)) done++; }
    }
  });

  weekRangeEl.textContent = showingAll? 'Entire plan' : weekLabel(forDate);
  weekMilesEl.textContent = showingAll? '' : `Week: ${miles.toFixed(1)} mi`;
  progressEl.textContent = showingAll? '' : `Done: ${runs? Math.round(100*done/runs):0}%`;
}
function updateStats(d){ render(d); }

function setWeekInput(date){
  const d=startOfWeek(date);
  const jan4=new Date(d.getFullYear(),0,4);
  const week=Math.ceil((((d-jan4)/86400000)+((jan4.getDay()+6)%7)+1)/7);
  weekPicker.value = `${d.getFullYear()}-W${String(week).padStart(2,'0')}`;
}

(function init(){
  rows=parseCSV(csvText);
  const start = rows.find(r=>r.DateISO>='2025-11-09')?.jsDate || rows[0].jsDate;
  setWeekInput(start);
  render(start);

  weekPicker.addEventListener('change',()=>{
    const [y,w]=weekPicker.value.split('-W').map(Number);
    const jan4=new Date(y,0,4);
    const mon=new Date(jan4.getTime()+(((w-1)*7-((jan4.getDay()+6)%7))*86400000));
    render(mon);
  });
  btnPrev.onclick=()=>{ const first=document.querySelector('#plan tbody td'); const now= first? new Date(first.textContent+'T00:00:00'):new Date();
    const d=startOfWeek(now); d.setDate(d.getDate()-7); setWeekInput(d); render(d); };
  btnNext.onclick=()=>{ const first=document.querySelector('#plan tbody td'); const now= first? new Date(first.textContent+'T00:00:00'):new Date();
    const d=startOfWeek(now); d.setDate(d.getDate()+7); setWeekInput(d); render(d); };
  btnShowAll.onclick=()=>{ showingAll=true; render(rows[0].jsDate); };
  btnShowWeek.onclick=()=>{ showingAll=false; const today=new Date(); setWeekInput(today); render(today); };
  btnReset.onclick=()=>{ if(confirm('Clear all checkmarks?')){ Object.keys(localStorage).forEach(k=>{if(k.startsWith('done:')) localStorage.removeItem(k)}); render(new Date()); } };
})();
</script>
</body>
</html>
